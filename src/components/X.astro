---
interface Props {
	url: string;
}
const { url } = Astro.props;

const base = "https://publish.x.com/oembed";
const baseUrl = new URL(base);
baseUrl.searchParams.set("url", url);
baseUrl.searchParams.set("omit_script", "true");

const post = await fetch(baseUrl.toString())
	.then<{ html: string }>((res) => res.json())
	.catch((err) => null);
---

{
	post && (
		<>
			<div set:html={post.html} />
			<script
				is:inline
				async
				src="https://platform.twitter.com/widgets.js"
				charset="utf-8"
				crossorigin="anonymous"
			/>
		</>
	)
}
